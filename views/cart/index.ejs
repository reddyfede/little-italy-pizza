<%- include('../partials/header') %>
    <link rel="stylesheet" href="/stylesheets/builder.css">

    <%if (order){%>
        <div>

            <div class="container my-5">
                <div class="row">
                    <div class="col-md-3 right">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class="card cart-summary">
                                        <h2>Cart Summary</h2>

                                        <div class="card-body">
                                            <% for( let i=0; i < order.items.pizzas.length; i++ ) { %>
                                                <li class="list-group-item d-flex justify-content-between lh-sm">
                                                    <div>
                                                        <span class="text-muted"><%- order.items.pizzas[i].name %>
                                                        </span>
                                                        <span class="text-muted">
                                                            (x<%-order.items.pizzas[i].quantity%>)</span>
                                                    </div>
                                                    <h6 class="my-0">$<%- order.items.pizzas[i].price *
                                                            order.items.pizzas[i].quantity %>
                                                    </h6>
                                                </li>
                                                <% } %>
                                        </div>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-9">
                        <div class="row g-5">
                            <div class="col-md-12">
                                <div class="row row-cols-1 row-cols-md-3 g-4">

                                    <% order.items.pizzas.forEach(pizza=>{ %>
                                        <div class="col">
                                            <div class="card" width="width:400px">
                                                <div id="builder">
                                                    <img style="z-index: 1;" class="crust-area"
                                                        src="../images/builder/crust/<%- pizza.crust.toLowerCase() %>.png">
                                                    <% for (let i=0; i < pizza.meats.length; i++) { %>
                                                        <img style="z-index: 1;" class="topping-area"
                                                            src="../images/builder/idle-toppings/<%-pizza.meats[i].toLowerCase().replace(/\s/g, '') %>.png">
                                                        <% } %>
                                                </div>
                                                <div class="card-body d-flex justify-content-center align-items-center">
                                                    <div class="col-lg-12">
                                                        <div class="row h-75 w-100 d-inline-block">
                                                            <div class="col-12">
                                                                <h5 class="card-title"><%- pizza.name %></h5>
                                                                <form method="POST"
                                                                    action="/order/cart/<%- pizza.id %>?_method=PUT">
                                                                    <div class="quantity-btns">
                                                                        <button type="submit" name="qty" value="-1"
                                                                            class="btn btn-primary btn-sm quantity-left"
                                                                            <%if(pizza.quantity===1){%>
                                                                            disabled <%} %>>-</button>
                                                                        <button
                                                                            class="btn disabled btn-sm quantity-display"><%-pizza.quantity%></button>
                                                                        <button type="submit" name="qty" value="+1"
                                                                            class="btn btn-primary btn-sm quantity-right">+</button>
                                                                    </div>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <%})%>

                                </div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <%} %>
            <%- include('../partials/footer') %>